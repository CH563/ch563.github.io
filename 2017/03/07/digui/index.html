<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Javascript的函数递归 · 陈立文</title><meta name="description" content="Javascript的函数递归 - 陈立文"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="container-wrap"><div class="wrap"><header><a href="/" class="logo-link"><img src="/gallery.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/categories/exp/" target="_self" class="nav-list-link">经验文章</a></li><li class="nav-list-item"><a href="/categories/study/" target="_self" class="nav-list-link">每日一撸</a></li><li class="nav-list-item"><a href="/categories/diary/" target="_self" class="nav-list-link">随笔</a></li><li class="nav-list-item"><a href="/2016/06/16/website/" target="_self" class="nav-list-link">前端导航</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">所有文章</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Javascript的函数递归</h1><div class="post-info">Mar 7, 2017</div><div class="post-content"><p>递归是什么？</p>
<p>想个标题已经让我很纠结了，究竟是函数递归还是递归函数？</p>
<p>看了下MDN的说明是：<strong> 函数可以被递归，就是说函数可以调用其本身。</strong></p>
<p>那递归就是函数的里面再调用自己，从而形成一个循环。</p>
<p>还是在实战才会学得更快，来战吧。</p>
<p>用递归计算阶乘:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n * factorial(n - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里就是函数里，调用了自己不停的互乘。当运行<code>factorial(5)</code>就不停计算 <code>5*4*3*2...</code>的计算下去，但问题是这没有尽头呀！直到栈溢出抛出 Uncaught RangeError: Maximum call stack size exceeded(…) 也不会有返回值。</p>
<p>这种无尽的递归称为死递归，它和死循环一样恐怖。</p>
<a id="more"></a>
<p>所有循环的程序都会有一个退出条件，对于每一个递归的程序，也都会有一个退出条件，加入退出条件后，函数就成了这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ((n == <span class="number">0</span>) || (n == <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> (n * factorial(n - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line">factorial(<span class="number">5</span>); <span class="comment">// 120</span></span><br></pre></td></tr></table></figure>
<p>使用递归的时候要注意出口,不return出口会造成死循环。</p>
<p>看到这里，你可能会想说递归不就是循环吗？这种for都可以简单实现啦。</p>
<p>没错，递归就是一个循环，自身的一个循环。</p>
<p>循环的时间复杂度和空间复杂度都优于用递归实现。</p>
<p>递归是方法调用本身,总是要进出堆栈内存,容易导致内存溢出,并且运行慢,循环是直接在内存中执行,速度快。</p>
<p>递归的优越性在于条理清晰，可读性强，比较适宜于问题本身是递归性质的、用循环难于解决的问题。在二者都不难的情况下，一般都是优先选用循环来解决问题的。</p>
<h3 id="写一个99乘法表"><a href="#写一个99乘法表" class="headerlink" title="写一个99乘法表"></a>写一个99乘法表</h3><p>这一个简单的实战例子，相信刚开始学javascript时，老师都给你布置这道作业，直接用两个for就可以轻松实现:</p>
<p>可以直接复杂代码，放到控制台就可以运行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">9</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">1</span>; j&lt;=i; j++)&#123;</span><br><span class="line">        <span class="built_in">document</span>.writeln(j+<span class="string">" x "</span>+i+<span class="string">"="</span>+i*j);</span><br><span class="line">       <span class="keyword">if</span> (j==i) &#123;</span><br><span class="line">           <span class="built_in">document</span>.writeln(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果如下：</p>
<p><img src="/images/99sfb.jpg" alt=""></p>
<p>让我跟据递归简单的实现一个：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ss = <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;<span class="number">0</span> &amp;&amp; x&lt;=<span class="number">9</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;=x;i++)&#123;</span><br><span class="line">            <span class="built_in">document</span>.writeln(i+<span class="string">"x"</span>+x+<span class="string">"="</span>+x*i);</span><br><span class="line">            <span class="keyword">if</span>(i==x)&#123;</span><br><span class="line">                <span class="built_in">document</span>.write(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ss(++x)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ss(<span class="number">1</span>)<span class="comment">//从1开始;改成9，函数里就要改成减了，实现出来就倒过来了</span></span><br></pre></td></tr></table></figure>
<p>效果一模一样(哈哈，其实我是用了同一张图…)：</p>
<p><img src="/images/99sfb.jpg" alt=""></p>
<p>上面函数还是有用到for呀，下面我们用纯的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jj = <span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1</span>&amp;&amp;y==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">document</span>.writeln(x+<span class="string">"x"</span>+y+<span class="string">"="</span>+x*y);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//注意这个return出口，不然会死循环</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(y==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">document</span>.writeln(x+<span class="string">"x"</span>+y+<span class="string">"="</span>+x*y);</span><br><span class="line">        <span class="built_in">document</span>.writeln(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">        x--;</span><br><span class="line">        y=x;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.writeln(x+<span class="string">"x"</span>+y+<span class="string">"="</span>+x*y);</span><br><span class="line">        --y;</span><br><span class="line">    &#125;</span><br><span class="line">    jj(x,y);</span><br><span class="line">&#125;</span><br><span class="line">jj(<span class="number">9</span>,<span class="number">9</span>)</span><br></pre></td></tr></table></figure>
<p>这个也可以实现效果，只是真的是倒过来了(哈哈….)</p>
<p><img src="/images/99fsb2.jpg" alt=""></p>
<hr>
<p><strong> 在知乎看到有个大神，用递归实现 javascript 中常用的 forEach map filter 函数。<br>作者：韦捷  访问地址：<a href="https://www.zhihu.com/question/54359554/answer/139040476" target="_blank" rel="external">https://www.zhihu.com/question/54359554/answer/139040476</a> </strong></p>
<p>下面让我把实现方法搬运过来装装逼：</p>
<p>先编写两个辅助函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 得到 array 的第一个元素</span></span><br><span class="line"><span class="comment">// head([1,2,3,4,5])</span></span><br><span class="line"><span class="comment">// =&gt; 1</span></span><br><span class="line"><span class="keyword">var</span> head = <span class="function"><span class="keyword">function</span> (<span class="params">array</span>)  </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到 array 除第一个元素外的其他元素</span></span><br><span class="line"><span class="comment">// tail([1,2,3,4,5])</span></span><br><span class="line"><span class="comment">// =&gt; [2,3,4,5]</span></span><br><span class="line"><span class="keyword">var</span> tail = <span class="function"><span class="keyword">function</span> (<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> array.slice(<span class="number">1</span>, array.length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>forEach 时会遍历作为第一个参数的数组，并且逐个将数组中的成员作为参数传给 fn 函数执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> forEach = <span class="function"><span class="keyword">function</span> (<span class="params">array, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (array.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    fn(head(array))<span class="comment">//传进的函数调用数组的第一个值</span></span><br><span class="line">    forEach(tail(array), fn)<span class="comment">//重新调用剩下的数组</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">forEach([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="built_in">console</span>.log(x) &#125;)</span><br><span class="line"><span class="comment">// =&gt; 1</span></span><br><span class="line"><span class="comment">// =&gt; 2</span></span><br><span class="line"><span class="comment">// =&gt; 3</span></span><br></pre></td></tr></table></figure>
<p>map 时会遍历作为第一个参数的数组，并且逐个将数组中的成员作为参数传给 fn 函数执行，然后将 fn 的返回值逐个装入新数组，最后返回新数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="function"><span class="keyword">function</span> (<span class="params">array, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (array.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [fn(head(array))].concat(map(tail(array), fn))<span class="comment">//实现每个值+1后合并</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">map([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> x+<span class="number">1</span> &#125;)</span><br><span class="line"><span class="comment">// =&gt; [2,3,4]</span></span><br></pre></td></tr></table></figure>
<p>filter 时会遍历作为第一个参数的数组，并且逐个将数组中的成员作为参数传给 fn 函数执行，如果 fn 的返回值是 true 则将当前参数装入新数组，否则忽略当前参数，最后返回新数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> filter = <span class="function"><span class="keyword">function</span> (<span class="params">array, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (array.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (fn(head(array)) === <span class="literal">true</span>) &#123;</span><br><span class="line">       <span class="keyword">return</span> [head(array)].concat(filter(tail(array), fn))<span class="comment">//实现每个&gt;2的值合并</span></span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       <span class="keyword">return</span> [].concat(filter(tail(array), fn))</span><br><span class="line">     &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">filter([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123; <span class="keyword">return</span> x&gt;<span class="number">2</span> &#125;)</span><br><span class="line"><span class="comment">// =&gt; [3,4,5]</span></span><br></pre></td></tr></table></figure>
<h3 id="JSON中最常用到"><a href="#JSON中最常用到" class="headerlink" title="JSON中最常用到"></a>JSON中最常用到</h3><p>用到了递归函数，用来调用json的子节点，把所有json中的子节点中包含某个数的object，都push到一个数组中，然后对其进行绑定。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr=[];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(data.itemId==<span class="string">"4323"</span>)&#123;</span><br><span class="line">        arr.push(item_data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(data.Childs)&#123;</span><br><span class="line">      <span class="keyword">if</span>(data.Childs.length&gt;<span class="number">0</span>)&#123;</span><br><span class="line">          getChilds(data.Childs)</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getChilds</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;data.length;i++)&#123;</span><br><span class="line">        getData(data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>更深入的应用还有二叉树的遍历等…</p>
<p><strong> 参考资料 </strong></p>
<ul>
<li><a href="https://www.zhihu.com/question/54359554/answer/139040476" target="_blank" rel="external">https://www.zhihu.com/question/54359554/answer/139040476</a></li>
<li><a href="http://www.haorooms.com/post/js_dg_jsdihanshu" target="_blank" rel="external">http://www.haorooms.com/post/js_dg_jsdihanshu</a></li>
</ul>
</div></article></div></section><footer><div class="paginator"><a href="/2017/02/28/websjk/" class="next">NEXT</a></div><div data-thread-key="2017/03/07/digui/" data-title="Javascript的函数递归" data-url="http://ch563.github.io/2017/03/07/digui/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"ch563"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2016 - 2017 <a href="http://ch563.github.io">陈立文</a>,<a href="https://hexo.io/" target="_blank">Hexo</a>Theme by<a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">apollo</a></p><p><a href="https://github.com/CH563" target="_blank"><img src="/img/github.png" class="github"></a><a href="http://codepen.io/ch563/" target="_blank"><img src="/img/codepen.png" class="github"></a><a href="/atom.xml" target="_blank"><img src="/img/rss.png" class="github rss"></a></p></div></footer></div></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>